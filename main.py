from scanner.port_scanner import scan_ports
from utils.network_utils import ping_target, traceroute_target
import argparse


def main():
    parser = argparse.ArgumentParser(
        description="Vulnerability Scanner - Scan ports and identify potential vulnerabilities.")
    parser.add_argument("target", help="Target IP address to scan")
    parser.add_argument("--full", action="store_true", help="Perform a full range scan (ports 1-1024)")
    parser.add_argument("--range", nargs=2, metavar=("start_port", "end_port"), type=int,
                        help="Specify a range of ports to scan")
    parser.add_argument("--port", type=int, help="Specify a specific port to scan")
    parser.add_argument("--ping", action="store_true", help="Ping the target to check if it's reachable")
    parser.add_argument("--traceroute", action="store_true", help="Perform a traceroute to the target")

    args = parser.parse_args()

    if args.ping:
        # Ping the target
        ping_target(args.target)

    if args.traceroute:
        # Perform a traceroute to the target
        traceroute_target(args.target)

    if args.full:
        # Full range scan
        scan_ports(args.target, 1, 1024)
    elif args.range:
        # Custom range scan
        start_port, end_port = args.range
        scan_ports(args.target, start_port, end_port)
    elif args.port:
        # Specific port scan
        scan_ports(args.target, args.port, args.port)
    else:
        print("Please provide a valid scan option. Use -h for help.")


if __name__ == "__main__":
    main()